{
    "$schema": "http://json-schema.org/schema#",
    "$schemaVersion": "0.0.1",
    "modelTags": "",
    "$id": "https://raw.githubusercontent.com/smart-data-models/dataModel.RiskAssessment/master/Risk/schema.json",
    "title": "Smart Data Models - Risk Assessment - Risk Entity",
    "description": "Effect of uncertainty on objectives. An effect is a deviation from the expected\u2014positive and/or negative. Objectives can have different aspects (such as financial, health and safety, and environmental goals) and can apply at different levels (such as strategic, organization-wide, project, product and process). Risk is often characterized by reference to potential events and consequences, or a combination of these. Risk is often expressed in terms of a combination of the consequences of an event (including changes in circumstances) and the associated likelihood of occurrence. Uncertainty is the state, even partial, of deficiency of information related to, understanding or knowledge of, an event, its consequence, or likelihood.",
    "type": "object",
    "allOf": [
        {
            "$ref": "https://smart-data-models.github.io/data-models/common-schema.json#/definitions/GSMA-Commons"
        },
        {
            "$ref": "https://smart-data-models.github.io/data-models/common-schema.json#/definitions/Location-Commons"
        },
        {
            "properties": {
                "type": {
                    "type": "string",
                    "description": "Property. NGSI-LD Entity Type. It must be equal to Risk.",
                    "enum": [
                        "Risk"
                    ]
                },
                "validTo": {
                    "type": "string",
                    "format": "date-time",
                    "description": "Property. Model:'https://schema.org/DateTime'. The time at which the risk materialization is started."
                },
                "validFrom": {
                    "type": "string",
                    "format": "date-time",
                    "description": "Property. Model:'https://schema.org/DateTime'. The time at which the risk materialization is finished."
                },
                "consequence": {
                    "type": "string",
                    "enum": [
                        "quality",
                        "quantity",
                        "reputation"
                    ],
                    "description": "Property. The consequence caused by a risk materialization. Enum:'quality, quantity, reputation'"
                },
                "description": {
                    "type": "string",
                    "description": "Property. The risk description in a natural language"
                },
                "event": {
                    "type": "string",
                    "enum": [
                        "destruction",
                        "interruption",
                        "manipulation",
                        "pollution"
                    ],
                    "description": "Property. Occurrence or change of a particular set of circumstances. Enum:'destruction, interruption, manipulation, pollution'"
                },
                "threat": {
                    "type": "string",
                    "enum": [
                        "cyber",
                        "cyber-physical",
                        "physical"
                    ],
                    "description": "Property. The potential cause of an incident that may result in a breach of information security or compromise business operations. Enum:'cyber, cyber-physical, physical'"
                },
                "severity": {
                    "type": "string",
                    "enum": [
                        "LOW",
                        "MEDIUM",
                        "HIGH"
                    ],
                    "description": "Property. The impact generated by the associated Risk. Enum:'LOW, MEDIUM, HIGH'"
                },
                "isOutputOf": {
                    "type": "array",
                    "description": "Relationship. Array of URIs of the different Geospatial Data Layers",
                    "items": {
                        "anyOf": [
                            {
                                "type": "string",
                                "minLength": 1,
                                "maxLength": 256,
                                "pattern": "^[\\w\\-\\.\\{\\}\\$\\+\\*\\[\\]`|~^@!,:\\\\]+$",
                                "description": "Property. Identifier format of any NGSI entity"
                            },
                            {
                                "type": "string",
                                "format": "uri",
                                "description": "Property. Identifier format of any NGSI entity"
                            }
                        ]
                    }
                },
                "sourceRisk": {
                    "type": "array",
                    "description": "Relationship. Array of URIs related to the source of the Risk that can be a Person, a Digital System, etc.",
                    "items": {
                        "anyOf": [
                            {
                                "type": "string",
                                "minLength": 1,
                                "maxLength": 256,
                                "pattern": "^[\\w\\-\\.\\{\\}\\$\\+\\*\\[\\]`|~^@!,:\\\\]+$",
                                "description": "Property. Identifier format of any NGSI entity"
                            },
                            {
                                "type": "string",
                                "format": "uri",
                                "description": "Property. Identifier format of any NGSI entity"
                            }
                        ]
                    }
                },
                "affects": {
                    "type": "array",
                    "description": "Relationship. Array of URIs related to the area in which the risk could affect.",
                    "items": {
                        "anyOf": [
                            {
                                "type": "string",
                                "minLength": 1,
                                "maxLength": 256,
                                "pattern": "^[\\w\\-\\.\\{\\}\\$\\+\\*\\[\\]`|~^@!,:\\\\]+$",
                                "description": "Property. Identifier format of any NGSI entity"
                            },
                            {
                                "type": "string",
                                "format": "uri",
                                "description": "Property. Identifier format of any NGSI entity"
                            }
                        ]
                    }
                },
                "mitigatedBy": {
                    "type": "array",
                    "description": "Relationship. Array of URIs related to the Mitigation Measures.",
                    "items": {
                        "anyOf": [
                            {
                                "type": "string",
                                "minLength": 1,
                                "maxLength": 256,
                                "pattern": "^[\\w\\-\\.\\{\\}\\$\\+\\*\\[\\]`|~^@!,:\\\\]+$",
                                "description": "Property. Identifier format of any NGSI entity"
                            },
                            {
                                "type": "string",
                                "format": "uri",
                                "description": "Property. Identifier format of any NGSI entity"
                            }
                        ]
                    }
                },
                "linkTo": {
                    "type": "array",
                    "description": "Relationship. Array of URIs related to the Mitigation Measures.",
                    "items": {
                        "anyOf": [
                            {
                                "type": "string",
                                "minLength": 1,
                                "maxLength": 256,
                                "pattern": "^[\\w\\-\\.\\{\\}\\$\\+\\*\\[\\]`|~^@!,:\\\\]+$",
                                "description": "Property. Identifier format of any NGSI entity"
                            },
                            {
                                "type": "string",
                                "format": "uri",
                                "description": "Property. Identifier format of any NGSI entity"
                            }
                        ]
                    }
                }
            }
        }
    ],
    "required": [
        "id",
        "type"
    ]
}